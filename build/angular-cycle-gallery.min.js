(function(){angular.module("multiGallery",["swipe","uuid4"])}).call(this),function(){angular.module("multiGallery").directive("galleryButton",["GalleryActions",function(t){return{restrict:"A",link:function(e,n,r){var i;return i=r.galleryButton,n.on("click",function(){return t[i]()})}}}])}.call(this),function(){angular.module("multiGallery").directive("galleryRepeater",["GalleryRenderer","ItemsStorage","GalleryMover","GalleryEvents",function(t,e,n,r){return{terminal:!0,transclude:"element",terminal:!0,$$tlb:!0,priority:1e3,link:function(i,o,s,u,l){var a,p,c,h,_,d,f,m;return h=s.galleryRepeater,c=h.match(/^\s*(.+)\s+in\s+(.*?)\s*(\s+track\s+by\s+(.+)\s*)?$/),_=c[1],p=c[2],a=o.parent(),m=new e,d=new t(i,_,a,l),f=new n(m,d,a,i),r.on("move:next",function(){return f.next()}),r.on("move:prev",function(){return f.prev()}),r.on("animate:next",function(){return f.animateNext()}),r.on("animate:prev",function(){return f.animatePrev()}),i.$watchCollection(p,function(t){return f.render(t)})}}}])}.call(this),function(){angular.module("multiGallery").service("GalleryActions",["GalleryEvents",function(t){return{next:function(){return t["do"]("move:next")},prev:function(){return t["do"]("move:prev")},animateNext:function(){return t["do"]("animate:next")},animatePrev:function(){return t["do"]("animate:prev")}}}])}.call(this),function(){angular.module("multiGallery").service("CycleGenerator",["uuid4",function(t){var e;return e=function(){function e(){}return e.prototype._count=0,e.prototype._items=[],e.prototype._cycleItems=[],e.prototype.setItems=function(t){return this._items=t,this._count=t.length,this._cycleItems=[],this._cycleGenerate(1)},e.prototype.sliceItems=function(t,e){return e>this._cycleItems.length-1&&this._cycleGenerate(Math.ceil(e/this._count)),this._cycleItems.slice(t,e)},e.prototype._cycleGenerate=function(t){var e,n,r,i,o;for(o=[],e=r=0,i=t;i>=0?i>=r:r>=i;e=i>=0?++r:--r)n=JSON.parse(JSON.stringify(this._items)),o.push(this._cycleItems=this._cycleItems.concat(this._addUIID(n)));return o},e.prototype._addUIID=function(e){var n,r,i;for(r=0,i=e.length;i>r;r++)n=e[r],n._$UUID=t.generate();return e},e}()}])}.call(this),function(){angular.module("multiGallery").service("GalleryEvents",[function(){return{_stack:{},on:function(t,e){return this._stack[t]||(this._stack[t]=[]),this._stack[t].push(e)},"do":function(t){var e,n,r,i,o;if(this._stack[t]){for(i=this._stack[t],o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(e());return o}}}}])}.call(this),function(){angular.module("multiGallery").service("GalleryRenderer",["RenderedItems",function(t){var e;return e=function(){function e(t,e,n,r){this._$scope=t,this._scopeItemName=e,this._$holder=n,this._transcludeFunction=r}return e.prototype._renderedItems=new t,e.prototype._transcludeFunction=null,e.prototype._$scope=null,e.prototype._scopeItemName=null,e.prototype._$holder=null,e.prototype.render=function(t){return this._renderedItems.markAllOutdated(),this._updateHolder(t),this._renderedItems.removeOutdated()},e.prototype.firstElement=function(){return this._renderedItems.firstElement()},e.prototype.getElementByIndex=function(t){return this._$holder.children().eq(t)[0]},e.prototype.getElementIndex=function(t){var e;for(e=0;null!==(t=t.previousSibling);)++e;return e},e.prototype._updateHolder=function(t){var e,n,r,i,o;for(i=null,o=[],n=0,r=t.length;r>n;n++)e=t[n],this._renderedItems.isRendered(e,!0)||this._addItemToHolder(i,e),o.push(i=e);return o},e.prototype._addItemToHolder=function(t,e){var n;return n=this._newItemScope(e),this._transcludeFunction(n,function(r){return function(i){return r._appendElement(r._renderedItems.findElementByData(t),i,e),r._renderedItems.add(n,i,e)}}(this))},e.prototype._appendElement=function(t,e){return null==t&&(t=null),null===t?this._$holder.prepend(e):t.after(e)},e.prototype._newItemScope=function(t){var e;return e=this._$scope.$new(),e[this._scopeItemName]=t,e},e}()}])}.call(this),function(){angular.module("multiGallery").service("ItemsStorage",["CycleGenerator",function(t){var e;return e=function(){function e(){}return e.prototype.NEAREST_ITEMS=2,e.prototype.items=[],e.prototype.index=0,e.prototype.counter=0,e.prototype.count=0,e.prototype.nextBuffer=0,e.prototype.prevBuffer=0,e.prototype.cycleMultiplier=0,e.prototype.nextCycleItems=new t,e.prototype.prevCycleItems=new t,e.prototype.setItems=function(t){return this.count=t.length,this.counter=this.count-1,this.items=t,this.nextCycleItems.setItems(this.items),this.prevCycleItems.setItems(this.items),this._fixIndex()},e.prototype.getNearestRange=function(){return 0===this.count?[]:[].concat(this.getPrevRangeItems(),this.getNextRangeItems())},e.prototype.getPrevRangeItems=function(){var t,e,n,r;return n=this.NEAREST_ITEMS+this.prevBuffer,t=((n+this.index)/this.count|0)+1,e=this.count*t-n+this.index,r=e+n,console.log(e,r),this.prevCycleItems.sliceItems(e,r)},e.prototype.getNextRangeItems=function(){var t,e,n;return e=this.NEAREST_ITEMS+this.nextBuffer,t=this.index,n=t+e+1,this.nextCycleItems.sliceItems(t,n)},e.prototype.nextIndex=function(){return++this.index,this._fixIndex()},e.prototype.prevIndex=function(){return--this.index,this._fixIndex()},e.prototype.getCurrentIndexInRange=function(){return this.NEAREST_ITEMS-this.prevBuffer+this.nextBuffer},e.prototype.clearRangeBuffer=function(){return this._clearNextBuffer(),this._clearPrevBuffer(),this._fixIndex()},e.prototype.incNextBuffer=function(){return++this.nextBuffer},e.prototype.getNextBuffer=function(){return this.nextBuffer},e.prototype.incPrevBuffer=function(){return++this.prevBuffer},e.prototype.getPrevBuffer=function(){return this.prevBuffer},e.prototype._clearNextBuffer=function(){return this.index+=this.nextBuffer,this.nextBuffer=0},e.prototype._clearPrevBuffer=function(){return this.index-=this.prevBuffer,this.prevBuffer=0},e.prototype._fixIndex=function(){var t,e;return t=!1,this.index>this.counter&&(this.index=this.index-this.count),this.index<0&&(this.index=this.count+this.index),0<=(e=this.index)&&e<=this.counter?void 0:this._fixIndex()},e}()}])}.call(this),function(){angular.module("multiGallery").service("GalleryMover",function(){var t;return t=function(){function t(t,e,n,r){this._storage=t,this._renderer=e,this._$holder=n,this._$scope=r}return t.prototype.ANIMATION_TIME=3e3,t.prototype.ANIMATION_SIDE_NEXT=1,t.prototype.ANIMATION_SIDE_PREV=2,t.prototype._storage=null,t.prototype._renderer=null,t.prototype._$holder=null,t.prototype._$scope=null,t.prototype._animation=null,t.prototype._itemWidth=0,t.prototype._currentIndex=0,t.prototype.render=function(t){return this._storage.setItems(t),this._renderer.render(this._storage.getNearestRange()),this._loadElementInfo(),this._syncCurrentIndex(),this._applyCurrentIndexPosition()},t.prototype.next=function(){return this._storage.nextIndex(),this._syncCurrentIndex(),this._rerender()},t.prototype.prev=function(){return this._storage.prevIndex(),this._syncCurrentIndex(),this._rerender()},t.prototype.animateNext=function(){return this._animation_type=this.ANIMATION_SIDE_NEXT,this._storage.incNextBuffer(),this._animate()},t.prototype.animatePrev=function(){return this._animation_type=this.ANIMATION_SIDE_PREV,this._storage.incPrevBuffer(),this._animate()},t.prototype._defaultAnimationTime=function(){return this.ANIMATION_TIME/1e3},t.prototype._stopPreviusAnimation=function(){return this._animation&&this._animation.pause(),this._animation?this._animation.kill():void 0},t.prototype._animate=function(t,e){return null==t&&(t=this._defaultAnimationTime()),null==e&&(e=this._positionForMoveIndex()),this._stopPreviusAnimation(),this._animation=TweenMax.to(this._$holder,t,{left:e+"px",ease:Linear.easeNone,onUpdate:function(t){return function(){return t._checkFrameChange()}}(this),onComplete:function(t){return function(){return t._onAnimationComplete()}}(this)})},t.prototype._onAnimationComplete=function(){return this._storage.clearRangeBuffer(),this._syncCurrentIndex(),this._rerender()},t.prototype._checkFrameChange=function(){var t,e,n,r,i;return(e=this._getDisplayIndex())===this._getCurrentIndex()?!1:(this._stopPreviusAnimation(),t=this._renderer.getElementByIndex(e),console.log(t),this._renderer.render(this._storage.getNearestRange()),this._$scope.$apply(),this._animation_type===this.ANIMATION_SIDE_NEXT?(this._currentIndex++,i=this._currentHolderPosition()%this._itemWidth+this._itemWidth,n=this._positionForMoveIndex()):(r=this._renderer.getElementIndex(t),this._currentIndex+=r-e,this._currentIndex--,i=this._currentHolderPosition()%this._itemWidth,n=this.__calculateCenterPositionForIndex(this._storage.NEAREST_ITEMS)),this._setHolderPosition(this._positionForCurrentIndex()+i),this._animate(null,n))},t.prototype._currentHolderPosition=function(){return parseInt(this._$holder.css("left"),10)},t.prototype._setHolderPosition=function(t){return this._$holder.css("left",t)},t.prototype._applyCurrentIndexPosition=function(){return this._setHolderPosition(this._positionForCurrentIndex())},t.prototype._positionForCurrentIndex=function(){return this.__calculateCenterPositionForIndex(this._getCurrentIndex())},t.prototype._getDisplayIndex=function(){return Math.abs(Math.round(this._currentHolderPosition()/this._itemWidth))},t.prototype._syncCurrentIndex=function(){return this._currentIndex=this._storage.getCurrentIndexInRange()},t.prototype._getCurrentIndex=function(){return this._currentIndex},t.prototype._positionForMoveIndex=function(){return this.__calculateCenterPositionForIndex(this._storage.getCurrentIndexInRange())},t.prototype.__calculateCenterPositionForIndex=function(t){return this._itemWidth*t*-1},t.prototype._loadElementInfo=function(){var t;return t=this._renderer.firstElement(),t?this._itemWidth=t.offsetWidth:void 0},t.prototype._rerender=function(){return this._renderer.render(this._storage.getNearestRange()),this._applyCurrentIndexPosition(),this._$scope.$apply()},t}()})}.call(this),function(){angular.module("multiGallery").service("RenderedItems",function(){var t;return t=function(){function t(){}return t.prototype._items=[],t.prototype.add=function(t,e,n){return this._items.push({scope:t,element:e,data:n,_$outedate:!1})},t.prototype.isRendered=function(t,e){var n,r,i,o;for(null==e&&(e=!1),o=this._items,r=0,i=o.length;i>r;r++)if(n=o[r],n.data._$UUID===t._$UUID)return e&&(n._$outedate=!1),!0;return!1},t.prototype.markAllOutdated=function(){var t,e,n,r,i;for(r=this._items,i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t._$outedate=!0);return i},t.prototype.removeOutdated=function(){var t,e,n,r,i,o,s,u,l;for(e=[],u=this._items,t=r=0,o=u.length;o>r;t=++r)n=u[t],n._$outedate&&(e.unshift(t),n.element.remove(),n.scope.$destroy());for(l=[],i=0,s=e.length;s>i;i++)t=e[i],l.push(this._items.splice(t,1));return l},t.prototype.findElementByData=function(t){var e,n,r,i;if(!t)return null;for(i=this._items,n=0,r=i.length;r>n;n++)if(e=i[n],e.data._$UUID===t._$UUID)return e.element},t.prototype.firstElement=function(){var t;return t=this._items[0],t?t.element[0]:void 0},t}()})}.call(this);